### SETUP CHUNK: Do NOT delete
###  Chunk 0 ###
# Overall Document Chunk Options
## Interesting note: This chuck is hard coded to include = FALSE for the CHUNK, but soft coded TRUE for the rest of the document. If you don't want a chunk to be included in output, you can change the Chunk to FALSE> BUT>>>>>>>>>>>> if you change this chunk to FALSE it makes all chunks false and unchangeable. ???????????????
###Necessary Packages for the Course (only needs to be done once, commented out for subsequent use)
#install.packages("mice") #Multivariate Imputation by Chained Equations, used for handling missing data
library(mice)
#install.packages("VIM") #Visualizing Missing Values, provides graphical visuals of missing data
library(VIM)
#install.packages("tidyverse") # Functions to create "Tidy" data.frames, inlcudes "dplyr".  A grammar of data manipulation, used for data wrangling
library(tidyverse)
# install.packages("ggplot2") #A system for creating visualizations, commonly used for data graphics
library(ggplot2)
# install.packages("reshape2") #Reshaping data between wide and long formats
library(reshape2)
#install.packages("corrplot") #Visualizes correlation matrices using graphs
library(corrplot)
#install.packages("regclass") #Custom package for regression, not required, but many of us are in the habit of using.
library(regclass)
#MORE ********************************
#install.packages("flextable") # Helps create "pretty" tables
library(flextable)
#install.packages("lubridate") # Helps handle to oddities and challenges of dates
library(lubridate)
#install.packages("rpart") # Decision Tree package
library(rpart)
#install.packages("rpart.plot") # Visualization of Decision Trees
library(rpart.plot)
## More packages may pop up or you may find ones you want ###**************
MainDF = read.csv("0 RawXy01miss v1.9.csv")
MainDF = read.csv("0 RawXy01miss v1.9.csv")
setwd(Users\david\Desktop\Spring-Semester-\Missing Data)
setwd("C:/Users/david/Desktop/Spring-Semester-/Missing Data")
MainDF = read.csv("0 RawXy01miss v1.9.csv")
###  Chunk 1 ###
setwd("C:/Users/david/Desktop/Spring-Semester-/Missing Data")
MainDF = read.csv("0 RawXy01miss v1.9.2csv")
###  Chunk 1 ###
setwd("C:/Users/david/Desktop/Spring-Semester-/Missing Data")
MainDF = read.csv("0 RawXy01miss v1.9.2csv")
MainDF = read.csv("Raw.csv")
StoreDF = read.csv("StoreTable.csv")
ConcessDF = read.csv("ConcessTable.csv")
CustomerDF = read.csv("CustomerTable.csv")
excluded_cols <- c()  # or character(0)
excluded_rows <- c()  # or character(0)
dim(MainDF)
dim(StoreDF)
dim(ConcessDF)
dim(CustomerDF)
colSums(is.na(MainDF))
colSums(is.na(StoreDF))
colSums(is.na(ConcessDF))
colSums(is.na(CustomerDF))
### Chunk 3 ###
# Step 1:  Open data in your software of choice (Arrange Columns, Other strange things)
## Make an identifier variable
#Reorder Columns Alphabetically, with Y-variable first
# Check the structure of the dataset to understand variable types
# str(data)
# sapply(data, class)
# Summary of numerical variables to spot outliers
# summary(data)
# Check categorical variables for potential typos or inconsistencies
# For example: factor variables
# sapply(data, function(x) if (is.factor(x)) levels(x))
# Plot histograms for numerical variables to identify outliers visually
# hist(data$NumericVariable)  # Replace 'NumericVariable' with the actual variable name
#  Step 2: . Review variables for common sense based on SME knowledge
dim(FFdf)
###  Chunk 2 ###
### COMMON SENSE STEP ###       ** Must be familiar with your data
# Do any "linking" or "Idenifying" variables need to be created ???????????????
### Make a flat file ***************** Focus on Merging issues *** CALL the Flat File "FFdf"
FFdf = MainDF; nrow(FFdf)
nrow(FFdf)
#********** Carry on my wayward son ................................
# FFdf =  # Single Flat File (FF) Dataframe for continued processing
#################### This is intended for the report, outside the chunk but won't knit unil set up is done:
# #### The full data set has:
#  **Rows = `r a[1]`**
#  **Columns = `r a[2]`**
FFdf$ID <- 1:nrow(FFdf)
View(FFdf)
y_var <- "Y01"
other_vars <- sort(setdiff(names(FFdf), y_var))
FFdf <- FFdf[, c(y_var, other_vars)]
View(FFdf)
# Check the structure of the dataset to understand variable types
str(FFdf)
sapply(FFdf, class)
sapply(FFdf, function(x) if (is.factor(x)) levels(x))
summary(FFdf)
summary(FFdf)
hist(data$Weejend.Attended)  # Replace 'NumericVariable' with the actual variable name
hist(data$Weekend.Attended)  # Replace 'NumericVariable' with the actual variable name
hist(FFdf$Weekend.Attended)  # Replace 'NumericVariable' with the actual variable name
names(FFdf) <- gsub("\\.", "_", names(FFdf))
names(FFdf) <- gsub(" ", "_", names(FFdf))
names(FFdf) <- gsub("(^|_)([a-z])", "\\1\\U\\2", names(FFdf), perl = TRUE)
names(FFdf)
View(MainDF)
###  Chunk 1 ###
setwd("C:/Users/david/Desktop/Spring-Semester-/Missing Data")
MainDF = read.csv("Raw.csv")
StoreDF = read.csv("StoreTable.csv")
ConcessDF = read.csv("ConcessTable.csv")
CustomerDF = read.csv("CustomerTable.csv")
### initialize variables to hold column and row names that are excluded.
excluded_cols <- c()  # or character(0)
excluded_rows <- c()  # or character(0)
### View Data in Viewer and variables in Global Environment for common sense  ***************************************************
### What do you notice about the data? Do you need to report this outside a chunk???
dim(MainDF)
dim(StoreDF)
dim(ConcessDF)
dim(CustomerDF)
colSums(is.na(MainDF))
colSums(is.na(StoreDF))
colSums(is.na(ConcessDF))
colSums(is.na(CustomerDF))
View(CustomerDF)
View(ConcessDF)
View(FFdf)
View(MainDF)
FFdf = MainDF; nrow(FFdf)
nrow(FFdf)
FFdf = merge(FFdf, StoreDF, by = "Cust_ID", all.x = TRUE)
nrow(FFdf)  # Should stay the same if it's a proper left join
# Merge with ConcessDF
FFdf = merge(FFdf, ConcessDF, by = "Cust_ID", all.x = TRUE)
nrow(FFdf)
# Merge with CustomerDF
FFdf = merge(FFdf, CustomerDF, by = "Cust_ID", all.x = TRUE)
nrow(FFdf)
# Store dimensions for reporting
a = dim(FFdf)
### Chunk 3 ###
# Step 1:  Open data in your software of choice (Arrange Columns, Other strange things)
## Make an identifier variable
FFdf$ID <- 1:nrow(FFdf)
#Reorder Columns Alphabetically, with Y-variable first
y_var <- "Y01"
other_vars <- sort(setdiff(names(FFdf), y_var))
FFdf <- FFdf[, c(y_var, other_vars)]
# Check the structure of the dataset to understand variable types
str(FFdf)
sapply(FFdf, class)
# Summary of numerical variables to spot outliers
summary(FFdf)
# Check categorical variables for potential typos or inconsistencies
# For example: factor variables
#sapply(FFdf, function(x) if (is.factor(x)) levels(x))
# Plot histograms for numerical variables to identify outliers visually
hist(FFdf$Weekend.Attended)  # Replace 'NumericVariable' with the actual variable name
#  Step 2: . Review variables for common sense based on SME knowledge
dim(FFdf)
## Let's get rid of spaces (r made .) in variable names, use underscore_
names(FFdf) <- gsub("\\.", "_", names(FFdf))
names(FFdf) <- gsub(" ", "_", names(FFdf))
## Let's make all variables start with a capital letter
names(FFdf) <- gsub("(^|_)([a-z])", "\\1\\U\\2", names(FFdf), perl = TRUE)
names(FFdf)
# Step 3:  Review how the software coded the variables (nominal, continuous) ## Think about Ordinal
####### Let's fix all the chr variables
## Do we want to make Educational_Level ordinal???
### >>>>>> xRow = 66723 ## Will delete this one row, there is no ID 44
length(unique(FFdf$Cust_ID))  ### hmmm is Cust_ID variable an identifier variable ????
# Step 4:  Perform data integrity/validation checks (misspelled levels, bogus values, combine levels which represent the same thing, etc.)
# Step 5: Handle Dates.**(extract relevant information, e.g., day of the week, hour of day)--------------**
# Extract day, month, and year for analysis
# data$DayOfWeek <- weekdays(data$DateColumn)
# data$Month <- format(data$DateColumn, "%m")
# data$Year <- format(data$DateColumn, "%Y")
sapply(FFdf, function(x) if (is.factor(x)) levels(x))
View(FFdf)
dim(FFdf)
## Let's get rid of spaces (r made .) in variable names, use underscore_
names(FFdf) <- gsub("\\.", "_", names(FFdf))
names(FFdf) <- gsub(" ", "_", names(FFdf))
## Let's make all variables start with a capital letter
names(FFdf) <- gsub("(^|_)([a-z])", "\\1\\U\\2", names(FFdf), perl = TRUE)
names(FFdf)
sapply(FFdf, class)
chr_vars <- names(FFdf)[sapply(FFdf, is.character)]
for(var in chr_vars) {
FFdf[[var]] <- as.factor(FFdf[[var]])
}
sapply(FFdf, class)
View(FFdf)
write.csv(FFdf, "FFdf_cleaned.csv", row.names = FALSE)
FFdf$Sex <- ifelse(FFdf$Sex == "M", 1,
ifelse(FFdf$Sex == "F", 0, NA))
FFdf$Sex <- as.numeric(FFdf$Sex)
# Convert Rejoined_STH (currently TRUE/FALSE boolean)
FFdf$Rejoined_STH <- as.numeric(FFdf$Rejoined_STH)
# Convert Playoffs (currently all "Yes" - might want to verify this is correct)
FFdf$Playoffs <- ifelse(FFdf$Playoffs == "Yes", 1, 0)
FFdf$Playoffs <- as.numeric(FFdf$Playoffs)
# Convert Mult_Loc (has "Yes", "Y", and "No")
FFdf$Mult_Loc <- ifelse(FFdf$Mult_Loc %in% c("Yes", "Y"), 1, 0)
FFdf$Mult_Loc <- as.numeric(FFdf$Mult_Loc)
# Convert Team_B_STH
FFdf$Team_B_STH <- ifelse(FFdf$Team_B_STH == "Yes", 1,
ifelse(FFdf$Team_B_STH == "No", 0, NA))
FFdf$Team_B_STH <- as.numeric(FFdf$Team_B_STH)
# Convert Team_C_STH
FFdf$Team_C_STH <- ifelse(FFdf$Team_C_STH == "Yes", 1,
ifelse(FFdf$Team_C_STH == "No", 0, NA))
FFdf$Team_C_STH <- as.numeric(FFdf$Team_C_STH)
# Convert Team_Network_Sub
FFdf$Team_Network_Sub <- ifelse(FFdf$Team_Network_Sub == "Yes", 1, 0)
FFdf$Team_Network_Sub <- as.numeric(FFdf$Team_Network_Sub)
# Verify the conversions
table(FFdf$Sex, useNA = "ifany")
table(FFdf$Rejoined_STH, useNA = "ifany")
table(FFdf$Playoffs, useNA = "ifany")
table(FFdf$Mult_Loc, useNA = "ifany")
table(FFdf$Team_B_STH, useNA = "ifany")
table(FFdf$Team_C_STH, useNA = "ifany")
table(FFdf$Team_Network_Sub, useNA = "ifany")
View(FFdf)
View(FFdf)
FFdf$Sex <- ifelse(FFdf$Sex == "M", 1,
ifelse(FFdf$Sex == "F", 0, NA))
FFdf$Sex <- as.numeric(FFdf$Sex)
### SETUP CHUNK: Do NOT delete
###  Chunk 0 ###
# Overall Document Chunk Options
## Interesting note: This chuck is hard coded to include = FALSE for the CHUNK, but soft coded TRUE for the rest of the document. If you don't want a chunk to be included in output, you can change the Chunk to FALSE> BUT>>>>>>>>>>>> if you change this chunk to FALSE it makes all chunks false and unchangeable. ???????????????
###Necessary Packages for the Course (only needs to be done once, commented out for subsequent use)
#install.packages("mice") #Multivariate Imputation by Chained Equations, used for handling missing data
library(mice)
#install.packages("VIM") #Visualizing Missing Values, provides graphical visuals of missing data
library(VIM)
#install.packages("tidyverse") # Functions to create "Tidy" data.frames, inlcudes "dplyr".  A grammar of data manipulation, used for data wrangling
library(tidyverse)
# install.packages("ggplot2") #A system for creating visualizations, commonly used for data graphics
library(ggplot2)
# install.packages("reshape2") #Reshaping data between wide and long formats
library(reshape2)
#install.packages("corrplot") #Visualizes correlation matrices using graphs
library(corrplot)
#install.packages("regclass") #Custom package for regression, not required, but many of us are in the habit of using.
library(regclass)
#MORE ********************************
#install.packages("flextable") # Helps create "pretty" tables
library(flextable)
#install.packages("lubridate") # Helps handle to oddities and challenges of dates
library(lubridate)
#install.packages("rpart") # Decision Tree package
library(rpart)
#install.packages("rpart.plot") # Visualization of Decision Trees
library(rpart.plot)
## More packages may pop up or you may find ones you want ###**************
###  Chunk 1 ###
setwd("C:/Users/david/Desktop/Spring-Semester-/Missing Data")
MainDF = read.csv("Raw.csv")
StoreDF = read.csv("StoreTable.csv")
ConcessDF = read.csv("ConcessTable.csv")
CustomerDF = read.csv("CustomerTable.csv")
### initialize variables to hold column and row names that are excluded.
excluded_cols <- c()  # or character(0)
excluded_rows <- c()  # or character(0)
### View Data in Viewer and variables in Global Environment for common sense  ***************************************************
### What do you notice about the data? Do you need to report this outside a chunk???
dim(MainDF)
dim(StoreDF)
dim(ConcessDF)
dim(CustomerDF)
colSums(is.na(MainDF))
colSums(is.na(StoreDF))
colSums(is.na(ConcessDF))
colSums(is.na(CustomerDF))
###  Chunk 2 ###
### COMMON SENSE STEP ###       ** Must be familiar with your data
# Do any "linking" or "Idenifying" variables need to be created ???????????????
### Make a flat file ***************** Focus on Merging issues *** CALL the Flat File "FFdf"
FFdf = MainDF; nrow(FFdf)
nrow(FFdf)
FFdf = merge(FFdf, StoreDF, by = "Cust_ID", all.x = TRUE)
nrow(FFdf)  # Should stay the same if it's a proper left join
# Merge with ConcessDF
FFdf = merge(FFdf, ConcessDF, by = "Cust_ID", all.x = TRUE)
nrow(FFdf)
# Merge with CustomerDF
FFdf = merge(FFdf, CustomerDF, by = "Cust_ID", all.x = TRUE)
nrow(FFdf)
# Store dimensions for reporting
a = dim(FFdf)
#********** Carry on my wayward son ................................
# FFdf =  # Single Flat File (FF) Dataframe for continued processing
#################### This is intended for the report, outside the chunk but won't knit unil set up is done:
# #### The full data set has:
#  **Rows = `r a[1]`**
#  **Columns = `r a[2]`**
View(FFdf)
### Chunk 3 ###
# Step 1:  Open data in your software of choice (Arrange Columns, Other strange things)
## Make an identifier variable
FFdf$ID <- 1:nrow(FFdf)
#Reorder Columns Alphabetically, with Y-variable first
y_var <- "Y01"
other_vars <- sort(setdiff(names(FFdf), y_var))
FFdf <- FFdf[, c(y_var, other_vars)]
# Check the structure of the dataset to understand variable types
str(FFdf)
sapply(FFdf, class)
# Summary of numerical variables to spot outliers
summary(FFdf)
# Check categorical variables for potential typos or inconsistencies
# For example: factor variables
#sapply(FFdf, function(x) if (is.factor(x)) levels(x))
# Plot histograms for numerical variables to identify outliers visually
hist(FFdf$Weekend.Attended)  # Replace 'NumericVariable' with the actual variable name
#  Step 2: . Review variables for common sense based on SME knowledge
dim(FFdf)
## Let's get rid of spaces (r made .) in variable names, use underscore_
names(FFdf) <- gsub("\\.", "_", names(FFdf))
names(FFdf) <- gsub(" ", "_", names(FFdf))
## Let's make all variables start with a capital letter
names(FFdf) <- gsub("(^|_)([a-z])", "\\1\\U\\2", names(FFdf), perl = TRUE)
names(FFdf)
# Step 3:  Review how the software coded the variables (nominal, continuous) ## Think about Ordinal
####### Let's fix all the chr variables
chr_vars <- names(FFdf)[sapply(FFdf, is.character)]
for(var in chr_vars) {
FFdf[[var]] <- as.factor(FFdf[[var]])
}
sapply(FFdf, class)
FFdf1 <- FFdf
FFdf1$Sex <- ifelse(FFdf$Sex == "M", 1,
ifelse(FFdf$Sex == "F", 0, NA))
FFdf1$Sex <- as.numeric(FFdf$Sex)
View(FFdf1)
